<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Substance - Mobile</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: black;
            /* Impedisce comportamenti di scroll/zoom nativi del browser mentre si tocca */
            touch-action: none; 
        }
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

    <canvas id="hydra-canvas"></canvas>
    <script src="https://unpkg.com/hydra-synth"></script>

    <script>
        // 1. INIZIALIZZAZIONE RESPONSIVE
        const hydra = new Hydra({
            canvas: document.getElementById("hydra-canvas"),
            detectAudio: false,
            enableStreamCapture: false
        });

        // Imposta la risoluzione basata sulle dimensioni reali del telefono
        // Questo mantiene l'aspetto nitido sia in verticale che in orizzontale
        setResolution(window.innerWidth, window.innerHeight);

        // Aggiorna la risoluzione se il telefono viene ruotato
        window.addEventListener('resize', () => {
            setResolution(window.innerWidth, window.innerHeight);
        });

        // --- BLOCCO TESTO OTTIMIZZATO PER MOBILE ---
        const textCanvas = document.createElement('canvas');
        const ctx = textCanvas.getContext('2d');

        function updateText() {
            textCanvas.width = window.innerWidth;
            textCanvas.height = window.innerHeight;
            ctx.clearRect(0, 0, textCanvas.width, textCanvas.height);
            
            // Calcola la dimensione del font in base alla larghezza (4% della larghezza schermo)
            // Questo assicura che la frase lunga entri nello schermo verticale
            const fontSize = Math.floor(window.innerWidth * 0.05); 
            
            ctx.font = '900 ' + fontSize + 'px Helvetica Neue, Arial, sans-serif';
            ctx.fillStyle = '#FFFFFF';
            ctx.textAlign = 'center';
            // Riduciamo leggermente lo spacing su mobile per far entrare tutto
            ctx.letterSpacing = '2px'; 

            const text = "ACTIVATE YOUR SUBCONSCIOUS";
            // Posizionato in basso, lasciando un margine sicuro per la barra di navigazione del telefono
            ctx.fillText(text, textCanvas.width / 2, textCanvas.height * 0.90);
        }

        updateText();
        window.addEventListener('resize', updateText);
        s0.init({ src: textCanvas, dynamic: true });

        // --- SCRIPT VISUALE ORIGINALE (Inalterato nella logica) ---
        // Nota: Su mobile 'mouse.x/y' corrispondono alla posizione del dito
        
        src(o0)
          .scale(1.05) 
          .modulate(noise(3, 0.1)) 
          .blend(
            voronoi(8, 2, 5) 
              .modulateScale(osc(10, 0.1, 0.5), 0.5) 
              .modulateRotate(noise(2, 0.2), () => (mouse.x * 0.005)) 
              .thresh(0.3, 0.0) 
              .color(
                () => 1 + (mouse.y * 0.001), 
                () => 0.4 + (mouse.y * 0.005), 
                () => 0.4 
              )
              .contrast(1.4)
              .brightness(0.1),
            0.1 
          )
          .modulatePixelate(noise(25, 0.5), 100, 8) 
          .layer(src(s0)) 
          .out(o0);

    </script>
</body>
</html>
